<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <link rel="stylesheet" type="text/css" href="../css/base_px.css" />
        <link rel="stylesheet" type="text/css" href="../css/iconfont.css" />
        <link rel="stylesheet" type="text/css" href="../css/login_reg_common.css" />
        <link rel="stylesheet" type="text/css" href="../css/login.css" />
        <script src="../lib/jquery-1.10.1.min.js" type="text/javascript"></script>
        <script type="text/javascript">
             $(function(){
                $('#loginbox li').click(function(){
                
                    $(this).attr('class','active')
                            .siblings()
                            .attr('class','');
                    $('#loginbox form').eq($(this).index())
                                  .css('display', 'block')
                                  .siblings()
                                  .css('display','none');
                })
             })
        </script>
    </head>
    <body>
        <!-- wrap 最外层盒子 -->
        <div id="wrap">
            <!-- top 顶部-->
            <div class="topadnew">       
            </div>

            <div id="topnav">
                <div class="topnav con"> 
                    <dl class="topnav_l fl">
                        <dd>您好！</dd>
                        <dd class="">
                                <a class="login-please"> 欢迎来到批发户!&nbsp;&nbsp;&nbsp;</a>
                        </dd>
                        <dd>
                                <a href="login.html" class="login-please" style="color:#bc338b">请登录</a>
                        </dd>
                        <dd class="topnav_line"></dd>
                        <dd class="">
                                <a href="reg.html" class="loginister-please">免费注册</a>
                        </dd>
                        <dd class="topnav_line"></dd>
                    </dl>
                    <dl class="topnav_r fr">
                        <dd>
                            <h2><a href="#">我的批发户<i class="commom-icon1"></i></a></h2>
                            <ul>
                                <li>
                                    <a href="#">我的订单</a>
                                </li>
                                <li>
                                    <a href="#">我的数据</a>
                                </li>
                                <li>
                                    <a href="#">我的产品</a>
                                </li>
                                <li>
                                    <a href="#">我的权限</a>
                                </li>
                                
                                <li>
                                    <a href="#">快速选购</a>
                                </li>
                                <li>
                                    <a href="#">产品动态</a>
                                </li>
                                
                                <li>
                                    <a href="#">我的API</a>
                                </li>
                                <li>
                                    <a href="#">我的钱包</a>
                                </li>
                                <li>
                                    <a href="#">账户管理</a>
                                </li>
                                <li>
                                    <a href="#">新手帮助</a>
                                </li>
                                
                            </ul>

                        </dd>
                        
                        <dd class="topnav_line"></dd>
                        <dd>
                            <h2><a href="#">收藏夹<i class="commom-icon1"></i></a></h2>
                            <ul style="width:auto;">
                                <li style="text-align:center;">
                                        <a href="javascript:;" onclick="GetLoginAndloginister()">收藏的货品</a>
                                </li>
                                <li style="text-align:center;">
                                        <a href="javascript:;" onclick="GetLoginAndloginister()">收藏的店铺</a>
                                </li>
                            </ul>
                        </dd> 
                        <dd class="topnav_line"></dd> 
                        <dd class="">
                            <a href="#" target="_blank">行业资讯</a>
                        </dd>
                        <dd class="topnav_line"></dd>
                        <dd>
                            <a href="#">我是卖家</a>
                        </dd>
                        
                        <dd class="topnav_line"></dd>
                        <dd>
                            <h2><a href="#">平台客服<i class="commom-icon1"></i></a></h2>
                            <ul style="width:auto;right: 3px;">
                                <li style="text-align:center;">
                                    <a target="_blank" href="#">卖家客服</a>
                                </li>
                                <li style="text-align:center;">
                                    <a target="_blank" href="#">买家客服</a>
                                </li>
                            </ul>
                        </dd>
                    </dl>
                </div>
            </div>

            <!-- #header 头部-->
            <div id="header">
                <div class="header con">
                    <div class="header_logo fl">
                        <a href="../index.html"><img src="../img/login_reg_pic/login_reg_logo.png" height="48" width="210"></a>
                    </div>
                    <h3 class="login_title fl">登录账户</h3>
                </div>
            </div>
            
            <!-- #main 主体-->
            <main>
                <div id="main" class="con">
                    <div id="loginbox">
                        <ul id="loginbox_hd">
                            <li class="active">密码登录</li>
                            <li>验证码登录</li>
                        </ul>
                        <div id="loginbox_bd">
                            <!-- 密码登录 -->
                            <form id="first" action="#" style="display:block;">
                                <input type="tel" id="user" value="" placeholder="手机号码"/>
                                <div for="phone" class="jianGe"><span id="inf1"></span></div>
                                <input type="password" id="psw" value="" placeholder="密码"/>
                                 <div for="psw" class="jianGe"><span id="inf2"></span></div>
                                <div class="remember" >
                                    <input type="checkbox" checked="checked" /><span>记住我</span>
                                    <a href="#" class="fr">忘记密码？</a>
                                </div>

                                <input type="button" value="登录" id="login"/>

                                <div class="register-free">
                                    <div class="right registerurl">
                                        <a href="reg.html">免费注册</a>
                                    </div>
                                </div>

                            </form>

                            <!-- 验证码登录 -->
                            <form id="second" action="#" style="display:none;">
                                <input type="tel" id="user2" value="" placeholder="手机"/>
                                <div for="phone" class="jianGe"><span id="inf3"></span></div>
                                <div id="codebox">
                                    <input class="fl" type="text" id="code" value="" placeholder="验证码"/>
                                    <input class="fl" type="button" id="btncode" value="免费获取验证码"/>
                                </div>
                                <div for="btncode" class="jianGe"><span id="inf4"></span></div>

                                <input type="button" value="登录" id="login2"/>

                                <div class="register-free">
                                    <div class="right registerurl">
                                        <a href="reg.html">免费注册</a>
                                    </div>
                                </div>

                            </form>
                        </div>
                    </div>
                </div>
            </main>
            
            <!--  foot 底部-->
            <footer>
                <article class="con">
                    <ul class="footer-main clearfix">
                        <li>
                            <dl>
                                <dt>新手指引</dt>
                                <dd>
                                    <a target="_blank" href="#">注册登录</a>
                                </dd>
                                <dd>
                                    <a target="_blank" href="#">选购下单</a>
                                </dd>
                                <dd>
                                    <a target="_blank" href="#">下载数据</a>
                                </dd>
                                <dd>
                                    <a target="_blank" href="#">批量刊登</a>
                                </dd>
                                <dd>
                                    <a target="_blank" href="#">物流配送</a>
                                </dd>
                                <dd>
                                    <a target="_blank" href="#">退货退款</a>
                                </dd>
                                <dd>
                                    <a target="_blank" href="#">常见问题</a>
                                </dd>
                            </dl>
                        </li>
                        <li>
                            <dl>
                                <dt>买家帮助</dt>
                                    <dd>
                                        <a target="_blank" href="#">账户资料</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">在线下单</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">产品数据</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">支付方式 </a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">退款退货</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">物流配送</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">售后服务</a>
                                    </dd>
                            </dl>
                        </li>
                        <li>
                            <dl>
                                <dt>卖家帮助</dt>
                                    <dd>
                                        <a target="_blank" href="#">怎么入驻</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">入驻条件</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">产品上架</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">申请提现</a>
                                    </dd>
                                    <dd>
                                        <a href="#">运费设置</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">发货管理</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">退货管理</a>
                                    </dd>
                            </dl>
                        </li>
                        <li>
                            <dl>
                                <dt>关于我们</dt>
                                    <dd>
                                        <a target="_blank" href="#">平台介绍</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">公司介绍</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">招商入驻</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">联系我们</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">招贤纳士</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">网站地图</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">合作伙伴</a>
                                    </dd>
                            </dl>
                        </li>
                        <li>
                            <dl>
                                <dt>活动专场</dt>
                                    <dd>
                                        <a target="_blank" href="#">采购伙拼</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">品牌授权</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">品牌商家</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">首饰产地</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">新品爆款</a>
                                    </dd>
                                    <dd>
                                        <a target="_blank" href="#">热销排行</a>
                                    </dd>
                            </dl>
                        </li>
                        <li class="tel">
                            <dl>
                                <dd class="text">销售客服热线</dd>
                                <dd class="lkn-tel" style="font-size: 18px;color: #e2a302;">400-860-5859</dd>
                                <dd class="text">投诉建议电话</dd>
                                <dd class="lkn-tel">18123977231</dd>
                                <dd class="text">周一至周日9:00-18:00</dd>
                            </dl>
                        </li>
                        <li>
                            <dl class="fr">
                                <img src="../img/footer_pic/MobileCode.png">
                                <br>
                                <span style="font-size: 12px;position: relative;top: 0px; color:#FFFFFF;">手机下单 轻松采购</span>
                            </dl>
                        </li>
                    </ul>

                    <div class="copyright con">
                        © 2019 PFHOO.com 版权所有 <a href="#" >粤ICP备11062211号</a>
                    </div>

                    <div class="footadd clearfix">
                        <a href="#">
                            <img style="margin-left:0px;" src="../img/footer_pic/newGovIcon.gif" height="52" width="128">
                        </a>

                        <img src="../img/footer_pic/aliyun.jpg" height="52" width="128">

                        <img src="../img/footer_pic/alipay.jpg" height="52" width="128">

                        <a href="#">
                            <img src="../img/footer_pic/pfhoo.jpg" height="52" width="128">
                        </a>

                        <a href="#">
                            <img src="../img/footer_pic/shiming.jpg" height="52" width="128">
                        </a>

                        <a href="#">
                            <img src="../img/footer_pic/Bottom_360rz.png" height="52" width="128">
                        </a>
                    </div>
                </article>
            </footer>

           <!--  右边导航栏 -->
            <div id="sider">
                <div class="sidebar_nav">
                    <div class="e-sidebar-b">
                        <a href="#" id="user">
                            <i class="icon iconfont icon-user1"></i>
                        </a>
                        <ul class="e-sidebar-tab">
                            <li id="sidebarchart" class="e-sidebar-boder">
                                <a href="#" class="e-shop-wrap e-nav-wrap">
                                     <img src="../img/shop_pic/receipt1.png" height="23" width="25">
                                     <i id="rightseven" class="e-icon e-icon-shop"></i>
                                     <p>进货单</p>
                                     <span id="J_sidebar_shop_num" style="display: inline-block;">0</span>
                                </a>
                            </li>
                            <li class="e-sidebar-item">
                                    <a href="javascript:;" class="e-shop-wrap e-nav-wrap" text-content="我的收藏">
                                        <i class="icon iconfont icon-shoucang"></i>
                                    </a>
                            </li>
                            <li class="e-sidebar-item">
                                <a target="_blank" href="#" class="e-shop-wrap e-nav-wrap" text-content="客服QQ">
                                    <i class="icon iconfont icon-qq" style="text-align:center;"></i>
                                </a>
                            </li>
                            <li class="e-sidebar-item">
                                <div class="e-shop-wrap e-nav-wrap" text-content="400 860 5859">
                                    <i class="icon iconfont icon-tel"></i>
                                </div>
                            </li>
                            <li class="e-sidebar-item">
                                <div class="e-shop-wrap e-nav-wrap" text-content="1">
                                    <i class="icon iconfont icon-erweima"></i>
                                </div>
                            </li>
                            <li class="e-sidebar-item">
                                <div class="e-shop-wrap e-nav-wrap" text-content="敬请期待">
                                    <i class="icon iconfont icon-youhuiquan"></i>
                                </div>
                            </li>
                        </ul>
                        <ul id="backtop">
                            <li>返回顶部</li>
                        </ul>
                    </div>
                </div>
                <div class="e-sidebar-panel">
                       
                </div>
            </div>

        </div>
    </body>
    <script src="../js/myquery-Ui.js" type="text/javascript" charset="utf-8"></script>
    <script type="text/javascript">
        var backtop = document.getElementById('backtop');
        //需求：滚动到300px的时候，就出现回到顶部按钮，点击按钮就可以快速回到顶部
        toSlowtop(backtop,400,140);
    </script>
    <script src="../js/common.js" type="text/javascript"></script>
    <script type="text/javascript">
            window.onload = () => {
                /*
                    * 验证用户名是否存在
                    * 不存在就允许注册
                    * 注册成功跳转到登陆页面
                    * 登陆功能，登陆成功跳到首页
                
                */
                //找节点
                let user = document.getElementById('user');
                let user2 = document.getElementById('user2');
                let  inf1 = document.getElementById('inf1');
                let inf2 = document.getElementById('inf2');
                let login = document.getElementById('login');
                let login2 = document.getElementById('login2');
                let psw = document.getElementById('psw');
                let code = document.getElementById('code');
                let btncode = document.getElementById('btncode');
                let first = document.getElementById('first');
                let second = document.getElementById('second');
                let isok1 = false;
                let isok2 = false;
                let isok3 = false;
                let isok4 = false;

                //前端：失去焦点的时候发送请求，把用户名传给后端
                let str = decodeURI(location.search.slice(1));
                console.log(str);
                user.value = str;
                user2.value = str;


                // 手机号码验证
                user.onblur = function(){
                    let tel = user.value.trim();//去掉前后空格
                    console.log(tel);
                    //非空判断
                    if(tel){                  
                       let res = RegExpCheck.tel(user.value);
                        console.log(res);
                        if(res){
                            inf1.innerHTML = '√'
                            css(inf1,'color','#58bc58');
                            isok1 = true;
                        }else{
                            inf1.innerHTML = '请输入正确的手机号码';
                            css(inf1,'color','red');
                            css(inf1,'fontSize','13px');
                            css(inf1,'marginLeft','15px');
                            isok1 = false;
                        }
                    }
                }

                // 第一种登陆方式
                //密码验证
                psw.onblur = function(){
                    var password =  psw.value.trim();//去掉前后空格
                    //非空判断
                    if(password){
                        isok2 = true;
                    }else{
                        inf2.innerHTML = '密码不能为空！';
                        css(inf2,'color','red');
                        css(inf2,'marginLeft','15px');
                        css(inf2,'fontSize','13px');
                        isok2 = false;
                    }
                }

                //登陆功能
                login.onclick = () =>{
                    if(user.value && psw.value){
                        ajax2({
                            type: 'post',
                            url: '../api/login.php',
                            data: 'user=' + user.value + '&psw=' + psw.value,
                            success : function(str) {
                                if(str == 'yes') {
                                    //成功：跳转到首页
                                    // location.href = 'main.html?' + userName.value;
                                    location.href = '../index.html';
                                    setCookie('user',user.value,1);//登陆的时候存到数据库
                                }else{
                                    alert('登陆失败：请输入正确的用户名或密码');
                                }
                            }
                        });
                    }else{
                        alert('请输入完整的信息')
                    }
                }

                // 第一种登陆方式
                first.onclick = function(){
                    css(second,'display','none');
                    //登陆功能
                    login.onclick = () =>{
                        if(user.value && psw.value){
                            ajax2({
                                type: 'post',
                                url: '../api/login.php',
                                data: 'user=' + user.value + '&psw=' + psw.value,
                                success : function(str) {
                                    if(str == 'yes') {
                                        //成功：跳转到首页
                                        // location.href = 'main.html?' + userName.value;
                                        location.href = '../index.html';
                                        setCookie('user',user.value,1);//登陆的时候存到数据库
                                    }else{
                                        alert('登陆失败：请输入正确的用户名或密码');
                                    }
                                }
                            });
                        }else{
                            alert('请输入完整的信息')
                        }
                    }
                }

                // 第二种登陆方式
                // 验证码
                second.onclick= function(){
                    css(first,'display','none');
                    // 手机号码验证
                    user2.onblur = function(){
                        let tel = user2.value.trim();//去掉前后空格
                        console.log(tel);
                        //非空判断
                        if(tel){                  
                           let res = RegExpCheck.tel(user2.value);
                            if(res){
                                inf3.innerHTML = '√'
                                css(inf3,'color','#58bc58');
                                isok4 = true;
                            }else{
                                inf3.innerHTML = '请输入正确的手机号码';
                                css(inf3,'color','red');
                                css(inf3,'fontSize','13px');
                                css(inf3,'marginLeft','15px');
                                isok4 = false;
                            }
                        }
                    }
                    // 验证码按钮
                    btncode.onclick = function(){
                        console.log(isok4);
                        if(isok4){//手机号码正常
                            var btncodeval = btncode.value;
                            var num = 60;
                            function showTime(){
                                btncodeval ='重新发送(' + num + ')';
                                num--;
                                btncode.disabled = 'disabled';
                                if(num < 0){
                                    clearInterval(timer);
                                    // val = '进入页面';
                                    btncodeval ='免费获取验证码';
                                    num=60;
                                    btncode.disabled = '';
                            }           
                                btncode.value = btncodeval;
                            }  
                            showTime();                          
                            var timer = setInterval(showTime,1000);

                            // 接收到短信验证码
                            code.onblur = function(){
                                var msg = '1234';
                                var codeval = code.value;
                                if(codeval == msg){
                                    // alert('验证通过')
                                    inf4.innerHTML = '√'
                                    css(inf4,'color','#58bc58');
                                    isok3 = true;

                                }else{
                                    inf4.innerHTML = '验证码不正确！';
                                    css(inf4,'color','red');
                                    css(inf4,'marginLeft','15px');
                                    isok3 = false;
                                }
                            }
                        }else{
                            alert('手机号码有误！请核实！');  
                        }                     
                    } 

                    // login2按钮
                    login2.onclick = function(){
                        ajax2({
                            type: 'post',
                            url: '../api/checkuser.php',
                            data: 'user=' + user2.value,
                            success : function(str) {
                                if(str == 'no') {//数据库存在
                                    //成功：跳转到首页
                                    // location.href = 'main.html?' + userName.value;
                                    location.href = '../index.html';
                                    setCookie('user',user2.value,1);//登陆的时候存到数据库
                                }else{
                                    alert('登陆失败：请输入正确的用户名或密码');
                                }
                            }
                        });
                    }
                }
            }        
        </script> 
</html>